<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>’Ñ’•’Æ ‘Ω’°’≤’°÷Å’°’∂’Ø - Ultimate Data Edition</title>
    <style>
        :root {
            --primary: #007bff; --success: #28a745; --danger: #dc3545;
            --warning: #ffc107; --dark: #2c3e50;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif; background: #eef2f7;
            margin: 0; padding: 10px; min-height: 100vh; display: flex;
            flex-direction: column; align-items: center; overflow-x: hidden; user-select: none;
        }
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 2000; display: none;
            justify-content: center; align-items: center;
        }
        .modal-content { background: white; padding: 40px; border-radius: 20px; text-align: center; }
        .setup-btn { padding: 15px 30px; margin: 10px; font-size: 20px; font-weight: bold; border-radius: 12px; cursor: pointer; color: white; border: none; }
        .game-header-area { display: none; width: 100%; max-width: 1100px; flex-direction: column; gap: 15px; }
        .scoreboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .team-box { background: #fff; border-radius: 15px; padding: 15px; border: 4px solid #d1d8e0; transition: 0.4s; }
        .team-box.active-turn { border-color: var(--success); background: linear-gradient(to bottom, #ffffff, #f0fff4); transform: translateY(-8px); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(40,167,69, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(40,167,69, 0); } 100% { box-shadow: 0 0 0 0 rgba(40,167,69, 0); } }
        .team-score { font-size: 42px; font-weight: 900; color: var(--dark); text-align: center; }
        .answer-input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; outline: none; }
        .game-container { display: none; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; max-width: 900px; margin-top: 25px; position: relative; }
        .tile-btn { min-height: 75px; border-radius: 12px; border: 2px solid var(--primary); background: white; color: var(--primary); font-size: 18px; font-weight: 800; cursor: pointer; transition: 0.3s; padding: 5px; }
        .tile-btn.game-active { background: var(--success) !important; color: white !important; border-color: transparent !important; font-size: 16px; }
        #effects-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .number-box-display { font-size: 180px; font-weight: 900; color: var(--success); background: white; width: 280px; height: 280px; border-radius: 20px; display: flex; justify-content: center; align-items: center; box-shadow: 0 20px 60px rgba(0,0,0,0.4); z-index: 10000; }
        .pop-animation { animation: slowPop 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
        .fly-to-target { transition: all 0.8s cubic-bezier(0.42, 0, 0.58, 1); position: fixed; z-index: 10001; }
        .effect-text-under { font-size: 70px; font-weight: 900; color: white; text-shadow: 3px 3px 20px rgba(0,0,0,0.6); animation: slideUp 0.8s 0.3s both; }
        @keyframes slowPop { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes slideUp { 0% { transform: translateY(40px); opacity: 0; } 100% { transform: translateY(0); opacity: 1; } }
        .disco-bg { animation: discoBg 0.4s infinite; }
        @keyframes discoBg { 0% { background: #ff7675; } 33% { background: #55efc4; } 66% { background: #74b9ff; } 100% { background: #a29bfe; } }
        .back-btn { display: none; position: fixed; bottom: 20px; left: 20px; padding: 12px 25px; background: var(--danger); color: white; border: none; border-radius: 30px; cursor: pointer; font-weight: bold; z-index: 100; }
    </style>
</head>
<body>

    <div id="teamModal" class="modal-overlay">
        <div class="modal-content">
            <h2 style="margin-bottom: 25px;">‘∏’∂’ø÷Ä’•÷Ñ ’©’´’¥’•÷Ä’´ ÷Ñ’°’∂’°’Ø’®</h2>
            <button class="setup-btn" style="background: #0984e3" onclick="confirmTeams(2)">2 ‘π’´’¥</button>
            <button class="setup-btn" style="background: #6c5ce7" onclick="confirmTeams(3)">3 ‘π’´’¥</button>
            <button class="setup-btn" style="background: #e84393" onclick="confirmTeams(4)">4 ‘π’´’¥</button>
        </div>
    </div>

    <button id="backButton" class="back-btn" onclick="backToMenu()">‚¨ÖÔ∏è ’é’•÷Ä’°’§’°’º’∂’°’¨ ’Ñ’•’∂’µ’∏÷Ç</button>
    <div id="effects-overlay"></div>

    <h2 id="main-title" style="margin-top: 20px;">‘±’á‘Ω‘±’ê’Ä‘±‘≥’ê‘±‘ø‘±’Ü ’î’ç‘±’Ü’Ö‘±‘ø’Ü‘µ’ê</h2>

    <div id="gameHeader" class="game-header-area">
        <div id="scoreboard" class="scoreboard"></div>
        <div style="display: flex; justify-content: center; gap: 15px; margin-top: 10px;">
            <button class="setup-btn" style="background: #636e72; padding: 10px 20px;" onclick="switchTurn()">‚áÑ ’ì’∏’≠’•’¨ ’∞’•÷Ä’©’®</button>
            <button class="setup-btn" style="background: var(--warning); color: black; padding: 10px 20px;" onclick="undo()">‚Ü©Ô∏è ’Ä’•’ø ÷Ñ’°’µ’¨</button>
        </div>
    </div>

    <div id="menuArea" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; width: 100%; max-width: 1200px; margin-top: 30px;"></div>
    <div id="gameArea" class="game-container"></div>

    <script>
        const allData = [
            { title: "‘µ÷Ä’Ø÷Ä’∂’•÷Ä’® ’®’Ω’ø ’¢’∂’°’Ø’π’∏÷Ç’©’µ’°’∂ ’©’æ’´", list: ["’Ä’∂’§’Ø’°’Ω’ø’°’∂ (1.43 ’¥’¨÷Ä’§)", "’â’´’∂’°’Ω’ø’°’∂ (1.41 ’¥’¨÷Ä’§)", "‘±’Ñ’Ü (335 ’¥’¨’∂)", "‘ª’∂’§’∏’∂’•’¶’´’° (277 ’¥’¨’∂)", "’ä’°’Ø’´’Ω’ø’°’∂ (240 ’¥’¨’∂)", "’Ü’´’£’•÷Ä’´’° (223 ’¥’¨’∂)", "‘≤÷Ä’°’¶’´’¨’´’° (216 ’¥’¨’∂)", "‘≤’°’∂’£’¨’°’§’•’∑ (172 ’¥’¨’∂)", "’å’∏÷Ç’Ω’°’Ω’ø’°’∂ (144 ’¥’¨’∂)", "‘µ’©’∏’æ’∫’´’° (126 ’¥’¨’∂)", "’Ñ’•÷Ñ’Ω’´’Ø’° (128 ’¥’¨’∂)", "’É’°’∫’∏’∂’´’° (123 ’¥’¨’∂)", "‘µ’£’´’∫’ø’∏’Ω (112 ’¥’¨’∂)", "’ñ’´’¨’´’∫’´’∂’∂’•÷Ä (117 ’¥’¨’∂)", "‘ø’∏’∂’£’∏ (102 ’¥’¨’∂)", "’é’´’•’ø’∂’°’¥ (99 ’¥’¨’∂)", "‘ª÷Ä’°’∂ (89 ’¥’¨’∂)", "‘π’∏÷Ç÷Ä÷Ñ’´’° (85 ’¥’¨’∂)", "‘≥’•÷Ä’¥’°’∂’´’° (83 ’¥’¨’∂)", "‘π’°’´’¨’°’∂’§ (71 ’¥’¨’∂)"] },
            { title: "‘µ÷Ä’Ø÷Ä’∂’•÷Ä’® ’®’Ω’ø ’ø’°÷Ä’°’Æ÷Ñ’´ ’¥’•’Æ’∏÷Ç’©’µ’°’∂", list: ["’å’∏÷Ç’Ω’°’Ω’ø’°’∂ (17.1 ’¥’¨’∂ ’Ø’¥¬≤)", "‘ø’°’∂’°’§’° (9.98 ’¥’¨’∂ ’Ø’¥¬≤)", "’â’´’∂’°’Ω’ø’°’∂ (9.59 ’¥’¨’∂ ’Ø’¥¬≤)", "‘±’Ñ’Ü (9.37 ’¥’¨’∂ ’Ø’¥¬≤)", "‘≤÷Ä’°’¶’´’¨’´’° (8.51 ’¥’¨’∂ ’Ø’¥¬≤)", "‘±’æ’Ω’ø÷Ä’°’¨’´’° (7.69 ’¥’¨’∂ ’Ø’¥¬≤)", "’Ä’∂’§’Ø’°’Ω’ø’°’∂ (3.28 ’¥’¨’∂ ’Ø’¥¬≤)", "‘±÷Ä’£’•’∂’ø’´’∂’° (2.78 ’¥’¨’∂ ’Ø’¥¬≤)", "’Ç’°’¶’°’≠’Ω’ø’°’∂ (2.72 ’¥’¨’∂ ’Ø’¥¬≤)", "‘±’¨’™’´÷Ä (2.38 ’¥’¨’∂ ’Ø’¥¬≤)", "‘ø’∏’∂’£’∏ (2.34 ’¥’¨’∂ ’Ø’¥¬≤)", "’ç’°’∏÷Ç’§’µ’°’∂ ‘±÷Ä’°’¢’´’° (2.14 ’¥’¨’∂ ’Ø’¥¬≤)", "’Ñ’•÷Ñ’Ω’´’Ø’° (1.96 ’¥’¨’∂ ’Ø’¥¬≤)", "‘ª’∂’§’∏’∂’•’¶’´’° (1.90 ’¥’¨’∂ ’Ø’¥¬≤)", "’ç’∏÷Ç’§’°’∂ (1.86 ’¥’¨’∂ ’Ø’¥¬≤)", "‘º’´’¢’´’° (1.75 ’¥’¨’∂ ’Ø’¥¬≤)", "‘ª÷Ä’°’∂ (1.64 ’¥’¨’∂ ’Ø’¥¬≤)", "’Ñ’∏’∂’≤’∏’¨’´’° (1.56 ’¥’¨’∂ ’Ø’¥¬≤)", "’ä’•÷Ä’∏÷Ç (1.28 ’¥’¨’∂ ’Ø’¥¬≤)", "’â’°’§ (1.28 ’¥’¨’∂ ’Ø’¥¬≤)"] },
            { title: "’Ü’°’æ’©’´ ’°’¥’•’∂’°’∑’°’ø ’∫’°’∑’°÷Ä’∂’•÷Ä ’∏÷Ç’∂’•÷Å’∏’≤’∂’•÷Ä’®", list: ["’é’•’∂’•’Ω’∏÷Ç’•’¨’° (303 ’¥’¨÷Ä’§ ’¢’°÷Ä’•’¨)", "’ç’°’∏÷Ç’§’µ’°’∂ ‘±÷Ä’°’¢’´’° (267 ’¥’¨÷Ä’§)", "‘ª÷Ä’°’∂ (208 ’¥’¨÷Ä’§)", "‘ø’°’∂’°’§’° (167 ’¥’¨÷Ä’§)", "‘ª÷Ä’°÷Ñ (145 ’¥’¨÷Ä’§)", "‘±’Ñ‘∑ (111 ’¥’¨÷Ä’§)", "’î’∏÷Ç’æ’•’µ’© (101 ’¥’¨÷Ä’§)", "’å’∏÷Ç’Ω’°’Ω’ø’°’∂ (80 ’¥’¨÷Ä’§)", "‘±’Ñ’Ü (68 ’¥’¨÷Ä’§)", "‘º’´’¢’´’° (48 ’¥’¨÷Ä’§)", "’Ü’´’£’•÷Ä’´’° (37 ’¥’¨÷Ä’§)", "’Ç’°’¶’°’≠’Ω’ø’°’∂ (30 ’¥’¨÷Ä’§)", "’â’´’∂’°’Ω’ø’°’∂ (26 ’¥’¨÷Ä’§)", "’î’°’©’°÷Ä (25 ’¥’¨÷Ä’§)", "‘≤÷Ä’°’¶’´’¨’´’° (13 ’¥’¨÷Ä’§)", "‘±’¨’™’´÷Ä (12 ’¥’¨÷Ä’§)", "’Ñ’•÷Ñ’Ω’´’Ø’° (10 ’¥’¨÷Ä’§)", "‘±’∂’£’∏’¨’° (8.2 ’¥’¨÷Ä’§)", "‘∑’Ø’æ’°’§’∏÷Ä (8.2 ’¥’¨÷Ä’§)", "’Ü’∏÷Ä’æ’•’£’´’° (7.6 ’¥’¨÷Ä’§)"] },
            { title: "‘±’∑’≠’°÷Ä’∞’´ ’•÷Ä’Ø÷Ä’∂’•÷Ä’® ’®’Ω’ø ’¢’µ’∏÷Ç’ª’•’´ ’Æ’°’æ’°’¨’´", list: ["‘±’Ñ’Ü ($4.8 ’ø÷Ä’¨’∂)", "’â’´’∂’°’Ω’ø’°’∂ ($3.7 ’ø÷Ä’¨’∂)", "‘≥’•÷Ä’¥’°’∂’´’° ($1.8 ’ø÷Ä’¨’∂)", "’É’°’∫’∏’∂’´’° ($1.6 ’ø÷Ä’¨’∂)", "’ñ÷Ä’°’∂’Ω’´’° ($1.5 ’ø÷Ä’¨’∂)", "’Ñ’•’Æ ‘≤÷Ä’´’ø’°’∂’´’° ($1.2 ’ø÷Ä’¨’∂)", "‘ª’ø’°’¨’´’° ($1.0 ’ø÷Ä’¨’∂)", "‘ø’°’∂’°’§’° ($650 ’¥’¨÷Ä’§)", "‘≤÷Ä’°’¶’´’¨’´’° ($630 ’¥’¨÷Ä’§)", "‘ª’Ω’∫’°’∂’´’° ($610 ’¥’¨÷Ä’§)", "‘±’æ’Ω’ø÷Ä’°’¨’´’° ($590 ’¥’¨÷Ä’§)", "’Ä’∂’§’Ø’°’Ω’ø’°’∂ ($580 ’¥’¨÷Ä’§)", "’Ä’°÷Ä’°’æ’°’µ’´’∂ ‘ø’∏÷Ä’•’° ($500 ’¥’¨÷Ä’§)", "’å’∏÷Ç’Ω’°’Ω’ø’°’∂ ($430 ’¥’¨÷Ä’§)", "’Ü’´’§’•÷Ä’¨’°’∂’§’∂’•÷Ä ($410 ’¥’¨÷Ä’§)", "’Ñ’•÷Ñ’Ω’´’Ø’° ($380 ’¥’¨÷Ä’§)", "‘≤’•’¨’£’´’° ($330 ’¥’¨÷Ä’§)", "’á’æ’•’µ÷Å’°÷Ä’´’° ($280 ’¥’¨÷Ä’§)", "’á’æ’•’§’´’° ($270 ’¥’¨÷Ä’§)", "’Ü’∏÷Ä’æ’•’£’´’° ($250 ’¥’¨÷Ä’§)"] },
            { title: "‘±’¥’•’∂’°’∑’°’ø ’¥’•÷Ñ’•’∂’° ’°÷Ä’ø’°’§÷Ä’∏’≤’∂’•÷Ä’®", list: ["’â’´’∂’°’Ω’ø’°’∂ (27 ’¥’¨’∂)", "‘±’Ñ’Ü (10 ’¥’¨’∂)", "’É’°’∫’∏’∂’´’° (7.8 ’¥’¨’∂)", "’Ä’∂’§’Ø’°’Ω’ø’°’∂ (5.4 ’¥’¨’∂)", "’Ä’°÷Ä’°’æ’°’µ’´’∂ ‘ø’∏÷Ä’•’° (3.7 ’¥’¨’∂)", "‘≥’•÷Ä’¥’°’∂’´’° (3.6 ’¥’¨’∂)", "’Ñ’•÷Ñ’Ω’´’Ø’° (3.5 ’¥’¨’∂)", "‘≤÷Ä’°’¶’´’¨’´’° (2.3 ’¥’¨’∂)", "‘ª’Ω’∫’°’∂’´’° (2.2 ’¥’¨’∂)", "‘π’°’´’¨’°’∂’§ (1.8 ’¥’¨’∂)", "‘ø’°’∂’°’§’° (1.5 ’¥’¨’∂)", "’ñ÷Ä’°’∂’Ω’´’° (1.3 ’¥’¨’∂)", "‘π’∏÷Ç÷Ä÷Ñ’´’° (1.3 ’¥’¨’∂)", "’â’•’≠’´’° (1.2 ’¥’¨’∂)", "‘ª’∂’§’∏’∂’•’¶’´’° (1.2 ’¥’¨’∂)", "‘ª÷Ä’°’∂ (1.1 ’¥’¨’∂)", "’ç’¨’∏’æ’°’Ø’´’° (1.0 ’¥’¨’∂)", "’Ñ’•’Æ ‘≤÷Ä’´’ø’°’∂’´’° (900 ’∞’°’¶.)", "‘ª’ø’°’¨’´’° (700 ’∞’°’¶.)", "’Ñ’°’¨’°’µ’¶’´’° (700 ’∞’°’¶.)"] },
            { title: "‘±’∑’≠’°÷Ä’∞’´ ’•÷Ä’Ø÷Ä’∂’•÷Ä’® ’®’Ω’ø ’∞’°’µ’•÷Ä’´ ÷Ñ’°’∂’°’Ø’´", list: ["’Ä’°’µ’°’Ω’ø’°’∂ (2.9 ’¥’¨’∂)", "’å’∏÷Ç’Ω’°’Ω’ø’°’∂ (1.2 ’¥’¨’∂)", "‘±’Ñ’Ü (800 ’∞’°’¶.)", "’ñ÷Ä’°’∂’Ω’´’° (600 ’∞’°’¶.)", "’é÷Ä’°’Ω’ø’°’∂ (170 ’∞’°’¶.)", "‘º’´’¢’°’∂’°’∂ (140 ’∞’°’¶.)", "‘±÷Ä’£’•’∂’ø’´’∂’° (120 ’∞’°’¶.)", "‘ª÷Ä’°’∂ (100 ’∞’°’¶.)", "’à÷Ç’Ø÷Ä’°’´’∂’° (100 ’∞’°’¶.)", "’ç’´÷Ä’´’° (80 ’∞’°’¶.)", "‘ø’°’∂’°’§’° (75 ’∞’°’¶.)", "‘≥’•÷Ä’¥’°’∂’´’° (60 ’∞’°’¶.)", "’à÷Ç’¶’¢’•’Ø’Ω’ø’°’∂ (50 ’∞’°’¶.)", "‘≤÷Ä’°’¶’´’¨’´’° (45 ’∞’°’¶.)", "’Ä’∏÷Ç’∂’°’Ω’ø’°’∂ (40 ’∞’°’¶.)", "‘ª’Ω÷Ä’°’µ’•’¨ (35 ’∞’°’¶.)", "‘π’∏÷Ç÷Ä÷Ñ’´’° (30 ’∞’°’¶.)", "‘±’æ’Ω’ø÷Ä’°’¨’´’° (25 ’∞’°’¶.)", "’Ç’°’¶’°’≠’Ω’ø’°’∂ (25 ’∞’°’¶.)", "’à÷Ç÷Ä’∏÷Ç’£’æ’°’µ (20 ’∞’°’¶.)"] },
            { title: "‘±’¥’•’∂’°’∑’°’ø ’ø’∏÷Ç÷Ä’´’Ω’ø’∂’•÷Ä ’®’∂’§’∏÷Ç’∂’∏’≤ ’•÷Ä’Ø÷Ä’∂’•÷Ä’®", list: ["’ñ÷Ä’°’∂’Ω’´’°", "‘ª’Ω’∫’°’∂’´’°", "‘±’Ñ’Ü", "‘ª’ø’°’¨’´’°", "‘π’∏÷Ç÷Ä÷Ñ’´’°", "’Ñ’•÷Ñ’Ω’´’Ø’°", "’Ñ’•’Æ ‘≤÷Ä’´’ø’°’∂’´’°", "‘≥’•÷Ä’¥’°’∂’´’°", "’Ä’∏÷Ç’∂’°’Ω’ø’°’∂", "‘±’æ’Ω’ø÷Ä’´’°", "‘π’°’´’¨’°’∂’§", "‘±’Ñ‘∑", "’ç’°’∏÷Ç’§’µ’°’∂ ‘±÷Ä’°’¢’´’°", "’É’°’∫’∏’∂’´’°", "’Ü’´’§’•÷Ä’¨’°’∂’§’∂’•÷Ä", "’Ñ’°’¨’°’µ’¶’´’°", "‘º’•’∞’°’Ω’ø’°’∂", "‘ø’°’∂’°’§’°", "’Ä’∏’∂’Ø’∏’∂’£", "‘Ω’∏÷Ä’æ’°’©’´’°"] },
            { title: "‘±’¥’•’∂’°’∑’°’ø ’¢÷Ä’´’∂’± ’°÷Ä’ø’°’§÷Ä’∏’≤ ’•÷Ä’Ø÷Ä’∂’•÷Ä’®", list: ["’â’´’∂’°’Ω’ø’°’∂", "’Ä’∂’§’Ø’°’Ω’ø’°’∂", "‘≤’°’∂’£’¨’°’§’•’∑", "‘ª’∂’§’∏’∂’•’¶’´’°", "’é’´’•’ø’∂’°’¥", "‘π’°’´’¨’°’∂’§", "’Ñ’µ’°’∂’¥’°", "’ñ’´’¨’´’∫’´’∂’∂’•÷Ä", "’ä’°’Ø’´’Ω’ø’°’∂", "‘≤÷Ä’°’¶’´’¨’´’°", "‘ø’°’¥’¢’∏’ª’°", "’É’°’∫’∏’∂’´’°", "’Ü’´’£’•÷Ä’´’°", "’Ü’•’∫’°’¨", "’á÷Ä’´ ‘º’°’∂’Ø’°", "‘µ’£’´’∫’ø’∏’Ω", "’Ä’°÷Ä’°’æ’°’µ’´’∂ ‘ø’∏÷Ä’•’°", "’Ñ’°’§’°’£’°’Ω’Ø’°÷Ä", "‘±’Ñ’Ü", "‘º’°’∏’Ω"] }
        ];

        let numTeams = 2, scores = [], activeTurn = 0, gameStates = [], history = [], currentGameIndex = -1, menuProgress = new Array(allData.length).fill(false);

        function renderMenu() {
            const container = document.getElementById("menuArea");
            container.style.display = "grid";
            document.getElementById("gameHeader").style.display = "none";
            document.getElementById("gameArea").style.display = "none";
            document.getElementById("backButton").style.display = "none";
            document.getElementById("main-title").innerText = "‘±’á‘Ω‘±’ê’Ä‘±‘≥’ê‘±‘ø‘±’Ü ’î’ç‘±’Ü’Ö‘±‘ø’Ü‘µ’ê";
            container.innerHTML = "";
            allData.forEach((item, idx) => {
                let btn = document.createElement("button");
                btn.className = "tile-btn";
                if (menuProgress[idx]) { btn.innerText = (idx + 1) + ". " + item.title; btn.classList.add("topic-confirmed"); btn.style.background = "#ffeaa7"; } else { btn.innerText = (idx + 1); }
                btn.onclick = () => { if (menuProgress[idx]) showTeamSelector(idx); else { menuProgress[idx] = true; renderMenu(); } };
                btn.oncontextmenu = (e) => { e.preventDefault(); menuProgress[idx] = false; renderMenu(); };
                container.appendChild(btn);
            });
        }

        function showTeamSelector(idx) { currentGameIndex = idx; document.getElementById("teamModal").style.display = "flex"; }
        function confirmTeams(count) { numTeams = count; document.getElementById("teamModal").style.display = "none"; startSession(); }

        function startSession() {
            document.getElementById("menuArea").style.display = "none";
            document.getElementById("gameArea").style.display = "grid";
            document.getElementById("gameHeader").style.display = "flex";
            document.getElementById("backButton").style.display = "block";
            document.getElementById("main-title").innerText = allData[currentGameIndex].title;
            gameStates = new Array(20).fill(false); scores = new Array(numTeams).fill(0); activeTurn = 0;
            buildScoreboard(); renderGrid(); focusInput();
        }

        function buildScoreboard() {
            const sb = document.getElementById("scoreboard");
            sb.innerHTML = "";
            for (let i = 0; i < numTeams; i++) {
                sb.innerHTML += `
                    <div id="team-${i}" class="team-box ${i===0?'active-turn':''}">
                        <input class="team-name-input" style="width:100%; border:none; text-align:center; font-weight:bold; font-size:18px;" value="‘π’´’¥ ${i+1}">
                        <div id="score-val-${i}" class="team-score">0</div>
                        <input id="input-${i}" class="answer-input" placeholder="’ä’°’ø’°’Ω’≠’°’∂..." onkeypress="if(event.key==='Enter') check(${i})">
                    </div>`;
            }
        }

        function renderGrid() {
            const container = document.getElementById("gameArea");
            container.innerHTML = "";
            for (let i = 0; i < 20; i++) {
                let btn = document.createElement("button");
                btn.className = "tile-btn " + (gameStates[i] ? "game-active" : "");
                btn.id = "btn-tile-" + i;
                btn.innerText = gameStates[i] ? (i+1)+". "+allData[currentGameIndex].list[i] : (i+1);
                btn.onclick = () => reveal(i);
                btn.oncontextmenu = (e) => { e.preventDefault(); if (gameStates[i]) { gameStates[i] = false; scores[activeTurn] -= (i + 1); updateUI(); renderGrid(); } };
                container.appendChild(btn);
            }
        }

        function focusInput() { setTimeout(() => { const input = document.getElementById(`input-${activeTurn}`); if (input) { input.focus(); input.value = ""; } }, 100); }

        function check(teamIdx) {
            if (teamIdx !== activeTurn) return;
            const val = document.getElementById(`input-${teamIdx}`).value.trim().toLowerCase();
            const list = allData[currentGameIndex].list;
            let found = -1;
            for (let i = 0; i < 20; i++) { if (!gameStates[i] && list[i].toLowerCase().includes(val) && val.length > 2) { found = i; break; } }
            if (found !== -1) reveal(found); else switchTurn();
        }

        function reveal(i) {
            if (gameStates[i]) return;
            history.push({scores: [...scores], turn: activeTurn, states: [...gameStates]});
            const overlay = document.getElementById("effects-overlay");
            overlay.style.display = "flex"; overlay.innerHTML = `<div class="number-box-display pop-animation">${i+1}</div>`;
            const h = i + 1;
            let effectText = h >= 19 ? "DISCO PARTY! üï∫‚ú®" : h >= 17 ? "WOW! üî•" : h >= 15 ? "üéØ PERFECT!" : h >= 13 ? "GREAT! üëç" : h >= 11 ? "GOOD! ‚ú®" : "";
            if (effectText) { if(h>=19) document.body.classList.add("disco-bg"); overlay.innerHTML += `<div class="effect-text-under">${effectText}</div>`; }
            setTimeout(() => {
                const numBox = overlay.querySelector('.number-box-display');
                const targetBtn = document.getElementById("btn-tile-" + i);
                const targetRect = targetBtn.getBoundingClientRect();
                const boxRect = numBox.getBoundingClientRect();
                numBox.classList.remove("pop-animation"); numBox.classList.add("fly-to-target");
                numBox.style.left = boxRect.left + "px"; numBox.style.top = boxRect.top + "px";
                setTimeout(() => { numBox.style.left = targetRect.left + "px"; numBox.style.top = targetRect.top + "px"; numBox.style.width = targetRect.width + "px"; numBox.style.height = targetRect.height + "px"; numBox.style.fontSize = "16px"; numBox.style.opacity = "0.5"; }, 50);
                setTimeout(() => { overlay.style.display = "none"; document.body.classList.remove("disco-bg"); gameStates[i] = true; scores[activeTurn] += (i + 1); updateUI(); renderGrid(); switchTurn(); }, 850);
            }, 2200);
        }

        function switchTurn() { activeTurn = (activeTurn + 1) % numTeams; updateUI(); focusInput(); }
        function updateUI() { for (let i = 0; i < numTeams; i++) { document.getElementById(`score-val-${i}`).innerText = scores[i]; document.getElementById(`team-${i}`).classList.toggle("active-turn", i === activeTurn); } }
        function undo() { if (history.length > 0) { let last = history.pop(); scores = last.scores; activeTurn = last.turn; gameStates = last.states; updateUI(); renderGrid(); focusInput(); } }
        function backToMenu() { if (confirm("’é’•÷Ä’°’§’°’º’∂’°’¨ ’¥’•’∂’µ’∏÷Ç’û")) renderMenu(); }
        renderMenu();
    </script>
</body>
</html>
